---
layout: post
comments: true
title: docker
---

#### [Docker in Production: A History of Failure](http://link.codetengu.com/Y0mLKup?m=rss)

對 Docker 滿滿的血淚控訴，事實上裡頭列的坑，我也幾乎都遇過，所以讀了特別地感同身受：

* 每次大更版，都隨著亮眼的新功能夾帶了小臭蟲，以及一些不向前相容的坑。
* 無法對 image 儲存空間做有效管理，為了這類小而惱人的問題，甚至要自己 call Docker API 寫個輔助程式處理。
* 類似上一點，至今若要自架 Docker Registry (v2) [依舊很難做 image 的空間管理](http://link.codetengu.com/PW7VG8B?m=rss)。最後若不是轉到付費的解決方案 (Docker Trusted Registry, AWS ECR...)，就是放棄使用 Docker Registry，改以 save & load 另走自己的一套 image 派送流程、迂迴曲折地 shipping。
* 莫衷一是的 storage drivers，選了任一個，就代表你被強制同梱了那一個 storage driver 適用的、特定版本的 Linux distribution。
* 資料庫之類仰賴 permanent disk storage 的應用，在 production 場合尤其不適合使用 Docker，無論哪種 workaround 都用起來綁手綁腳。

如果要做 immutable infrastructure，現在的我會比較偏好用 [Packer](http://link.codetengu.com/rXux1yn?m=rss) 做 VM image，仍以 VM 為應用程式的主要宿主，但是一些適用 container 的應用，我也不排斥使用 container。綜合考量適用場合、資源調度整合的便利性等因素，分別給予最合適的部署方式，而非一味地追逐酷炫潮夯、人云亦云、通通上 Docker。

[wordpress.com](http://link.codetengu.com/Y0mLKup?m=rss)


